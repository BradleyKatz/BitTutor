/*
	BitTutor index.js
	-----------------
	Written By: Bradley Katz and Gabriel Ngai
	Date: 2015-12-05
	
	This file contains a series of event handlers and other such methods that are used behind the scenes as users interacts with BitTutor's interface.
*/

var solverControlObject = null;
var practiceControlObject = null;

/*
	Event handler for clicking on the submit button in solver mode when doing arithmetic.
	Signals the solver control object to read in the user's problem, compute the solution, and present it to the user.
*/

$(document).on("click", "#SolverPage #arithmeticForm button.submit-button", function()
{
	solverControlObject.computeSolution();
	solverControlObject.displaySolution();
});

/*
	Event handler for clicking on the submit button in solver mode when doing conversions.
	Signals the solver control object to read in the user's conversion problem, compute the conversion, and present it to the user.
*/

$(document).on("click", "#SolverPage #conversionForm button.submit-button", function()
{
	solverControlObject.computeConversion();
	solverControlObject.displaySolution();
});

/*
	Event handler for clicking on the solver button on the home screen.
		- Initializes a SolverControl object
		- Signals for the arithmetic form to be displayed by default.
		- Initializes the solver page by resetting input fields and hiding the solution section.
*/

$(document).on("click", "#HomeScreen a.solver-button", function()
{	
	solverControlObject = new SolverControl();
	solverControlObject.displayArithmeticForm();
	initializeSolverPage();
});

/*
	Event handler for clicking on the practice button on the home screen.
		- Initializes a PracticeControl object.
		- Initializes the practice page by resetting input and output fields.
		- Selects "Decimal-to-Binary Conversion" by default. 
*/

$(document).on("click", "#HomeScreen a.practice-button", function()
{
	practiceControlObject = new PracticeControl();
	initializePracticePage();
});

/*
	Event handler for switching to arithmetic mode within solver mode.
		- Signals for the arithmetic form to be displayed to the user.
*/

$(document).on("click", "#SolverPage #solverTopicPanel a.arithmetic-button", function()
{
	solverControlObject.displayArithmeticForm();
});

/*
	Event handler for switching to conversion mode within solver mode.
		- Signals for the conversion form to be displayed to the user.
*/

$(document).on("click", "#SolverPage #solverTopicPanel a.conversion-button", function()
{
	solverControlObject.displayConversionForm();
});

/*
	Event handler for choosing a new topic in practice mode from the topic menu.
		- Resets the solution section.
		- Generates a new problem depending on the user's choice.
		- Signals for the solution to be generated.
		- Displays the new problem for the user.
*/

$(document).on("click", "#PracticePage #practiceTopicPanel a.panel-link", function()
{
	practiceControlObject.setSteps([]);
	practiceControlObject.resetStepsRevealed();
	practiceControlObject.setTopicChoice(String(this.innerHTML));
	practiceControlObject.generateProblem();
	practiceControlObject.computeSolution();
	document.getElementById("problem").innerHTML = practiceControlObject.getProblem();
});

/*
	Event handler for submitting a solution in practice mode.
		- Signals for the user's solution to be checked against the system's solution.
		- Displays a congratulatory message if the user was correct.
		- Informs the user if their solution was incorrect.
*/

$(document).on("click", "#PracticePage button.submit-button", function()
{
	practiceControlObject.validateUserSolution();
})

/*
	Event handler for skipping a problem in practice mode.
		- Signals for a new problem to be generated by the system.
*/

$(document).on("click", "#PracticePage button.skip-button", function()
{
	practiceControlObject.skipProblem();
});

/*
	Event handler for revealing a step in practice mode.
		- Signals for the next step of the solution (if one exists) to be displayed for the user.
*/

$(document).on("click", "#PracticePage button.reveal-button", function()
{
	practiceControlObject.revealStep();
});

/*
	Initializes the solver page by:
		- Resetting input and output fields.
		- Hiding the solution section
*/

var initializeSolverPage = function()
{
	document.getElementById("equationInput").value = "";
	document.getElementById("numberInput").value = "";
	$(document.getElementById("solutionSteps")).empty();
	$("#SolverPage #solverStepsSection").hide();
};

/*
	Initializes the practice page by:
		- Resetting input and output fields.
		- Resetting practice control to its default state.
		- Initializing the topic choice to "Decimal-to-Binary Conversion"
*/

var initializePracticePage = function()
{
	practiceControlObject.setSteps([]);
	practiceControlObject.resetStepsRevealed();
	practiceControlObject.setTopicChoice("Decimal-to-Binary Conversion");
	practiceControlObject.generateProblem();
	practiceControlObject.computeSolution();
	document.getElementById("problem").innerHTML = practiceControlObject.getProblem();
	document.getElementById("answerInput").value = "";
	$(document.getElementById("practiceSolutionSteps")).empty();
};